{"uid":"86d7c7ff7498d14c","name":"test_add_spend_with_category_name[chromium]","fullName":"tests.api.test_api_spends.TestApiSpends#test_add_spend_with_category_name","historyId":"2272fdf67e604012ab2a00ea2089f938","time":{"start":1770317097487,"stop":1770317097487,"duration":0},"status":"broken","statusMessage":"sqlalchemy.exc.NoResultFound: No row was found when one was required","statusTrace":"auth_client = <clients.auth_client.AuthClient object at 0x7facedf63e00>\ndb_client = <databases.userdata_db.UserdataDb object at 0x7facedea8980>\n\n    @pytest.fixture(scope=\"session\", autouse=True)\n    def create_test_user(auth_client, db_client: UserdataDb):\n        \"\"\"Создание тестового пользователя перед всеми тестами\"\"\"\n>       existing_user = db_client.get_user(os.getenv(\"TEST_USERNAME\"))\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nconftest.py:77: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ndatabases/userdata_db.py:34: in get_user\n    return session.exec(statement).one()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py:1815: in one\n    return self._only_one_row(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <sqlalchemy.engine.result.ScalarResult object at 0x7facedc935c0>\nraise_for_second_row = True, raise_for_none = True, scalar = False\n\n    def _only_one_row(\n        self,\n        raise_for_second_row: bool,\n        raise_for_none: bool,\n        scalar: bool,\n    ) -> Optional[_R]:\n        onerow = self._fetchone_impl\n    \n        row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)\n        if row is None:\n            if raise_for_none:\n>               raise exc.NoResultFound(\n                    \"No row was found when one was required\"\n                )\nE               sqlalchemy.exc.NoResultFound: No row was found when one was required\n\n.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py:760: NoResultFound","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"[S] Base Url","time":{"start":1770317096925,"stop":1770317096925,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S]  Verify Url","time":{"start":1770317096925,"stop":1770317096926,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Pytestconfig","time":{"start":1770317096926,"stop":1770317096926,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S]  Session Faker","time":{"start":1770317096926,"stop":1770317096928,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Delete Output Dir","time":{"start":1770317096926,"stop":1770317096926,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Envs","time":{"start":1770317096928,"stop":1770317096931,"duration":3},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Db Client","time":{"start":1770317096932,"stop":1770317097113,"duration":181},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Auth Client","time":{"start":1770317096932,"stop":1770317096932,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Create Test User","time":{"start":1770317097113,"stop":1770317097149,"duration":36},"status":"broken","statusMessage":"sqlalchemy.exc.NoResultFound: No row was found when one was required\n","statusTrace":"  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/_pytest/setuponly.py\", line 36, in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    return result.get_result()\n           ~~~~~~~~~~~~~~~~~^^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/pluggy/_result.py\", line 103, in get_result\n    raise exc.with_traceback(tb)\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/_pytest/fixtures.py\", line 1202, in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/_pytest/fixtures.py\", line 915, in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/conftest.py\", line 77, in create_test_user\n    existing_user = db_client.get_user(os.getenv(\"TEST_USERNAME\"))\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/databases/userdata_db.py\", line 34, in get_user\n    return session.exec(statement).one()\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py\", line 1815, in one\n    return self._only_one_row(\n           ~~~~~~~~~~~~~~~~~~^\n        raise_for_second_row=True, raise_for_none=True, scalar=False\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py\", line 760, in _only_one_row\n    raise exc.NoResultFound(\n        \"No row was found when one was required\"\n    )\n","steps":[{"name":"DB: attach sql","time":{"start":1770317097130,"stop":1770317097130,"duration":0},"status":"passed","steps":[],"attachments":[{"uid":"6b89e424c7b70c83","name":"select niffler-userdata","source":"6b89e424c7b70c83.txt","type":"text/plain","size":27}],"parameters":[{"name":"cursor","value":"<cursor object at 0x7facedc1e980; closed: 0>"},{"name":"statement","value":"'select pg_catalog.version()'"},{"name":"parameters","value":"immutabledict({})"},{"name":"context","value":"<sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x7facedc95e80>"}],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"DB: attach sql","time":{"start":1770317097132,"stop":1770317097132,"duration":0},"status":"passed","steps":[],"attachments":[{"uid":"fb884e9caed8167c","name":"select niffler-userdata","source":"fb884e9caed8167c.txt","type":"text/plain","size":23}],"parameters":[{"name":"cursor","value":"<cursor object at 0x7facedc1e980; closed: 0>"},{"name":"statement","value":"'select current_schema()'"},{"name":"parameters","value":"immutabledict({})"},{"name":"context","value":"<sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x7facedb2d090>"}],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"DB: attach sql","time":{"start":1770317097133,"stop":1770317097133,"duration":0},"status":"passed","steps":[],"attachments":[{"uid":"e792398e64197281","name":"show niffler-userdata","source":"e792398e64197281.txt","type":"text/plain","size":32}],"parameters":[{"name":"cursor","value":"<cursor object at 0x7facedc1e980; closed: 0>"},{"name":"statement","value":"'show standard_conforming_strings'"},{"name":"parameters","value":"immutabledict({})"},{"name":"context","value":"<sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x7facedb2d090>"}],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"DB: attach sql","time":{"start":1770317097146,"stop":1770317097146,"duration":0},"status":"passed","steps":[],"attachments":[{"uid":"316c3839326d2730","name":"SELECT niffler-userdata","source":"316c3839326d2730.txt","type":"text/plain","size":186}],"parameters":[{"name":"cursor","value":"<cursor object at 0x7facedc8d8a0; closed: 0>"},{"name":"statement","value":"'SELECT \"user\".id, \"user\".username, \"user\".currency, \"user\".firstname, \"user\".surname, \"user\".photo, \"user\".photo_small, \"user\".full_name \nFROM \"user\" \nWHERE \"user\".username = %(username_1)s'"},{"name":"parameters","value":"{'username_1': 'niffler_st3'}"},{"name":"context","value":"<sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x7facedc6c510>"}],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":4,"shouldDisplayMessage":true,"attachmentsCount":4,"hasContent":true,"attachmentStep":false}],"afterStages":[],"labels":[{"name":"feature","value":"Spends"},{"name":"tag","value":"ACTIONS_API"},{"name":"story","value":"Spend"},{"name":"epic","value":"Niffler app"},{"name":"parentSuite","value":"tests.api"},{"name":"suite","value":"test_api_spends"},{"name":"subSuite","value":"TestApiSpends"},{"name":"host","value":"runnervmkj6or"},{"name":"thread","value":"10041-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.api.test_api_spends"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"browser_name","value":"'chromium'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":["ACTIONS_API"]},"source":"86d7c7ff7498d14c.json","parameterValues":["'chromium'"]}