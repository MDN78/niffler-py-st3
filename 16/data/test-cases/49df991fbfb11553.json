{"uid":"49df991fbfb11553","name":"test_delete_all_spending[chromium-West Melanieview-city]","fullName":"tests.ui.test_spending.TestSpendPage#test_delete_all_spending","historyId":"20063f775c90007e12cfbf93bcf5d39f","time":{"start":1770323456376,"stop":1770323456376,"duration":0},"status":"broken","statusMessage":"sqlalchemy.exc.NoResultFound: No row was found when one was required","statusTrace":"auth_client = <clients.auth_client.AuthClient object at 0x7f2ac1ab30e0>\nenvs = Envs(frontend_url='http://frontend.niffler.dc', gateway_url='http://gateway.niffler.dc:8090', registration_url='http:/...th_db_url='postgresql+psycopg2://postgres:secret@localhost:5432/niffler-auth', soap_address='http://localhost:8089/ws')\n\n    @pytest.fixture(scope=\"session\", autouse=True)\n    def create_test_user(auth_client, envs: Envs):\n        \"\"\"Создание тестового пользователя перед всеми тестами\"\"\"\n>       existing_user = UserdataDb(envs).get_user(username=envs.test_username)\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nconftest.py:72: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ndatabases/userdata_db.py:34: in get_user\n    return session.exec(statement).one()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py:1815: in one\n    return self._only_one_row(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <sqlalchemy.engine.result.ScalarResult object at 0x7f2ac1856170>\nraise_for_second_row = True, raise_for_none = True, scalar = False\n\n    def _only_one_row(\n        self,\n        raise_for_second_row: bool,\n        raise_for_none: bool,\n        scalar: bool,\n    ) -> Optional[_R]:\n        onerow = self._fetchone_impl\n    \n        row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)\n        if row is None:\n            if raise_for_none:\n>               raise exc.NoResultFound(\n                    \"No row was found when one was required\"\n                )\nE               sqlalchemy.exc.NoResultFound: No row was found when one was required\n\n.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py:760: NoResultFound","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"[S] Base Url","time":{"start":1770323455198,"stop":1770323455198,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Pytestconfig","time":{"start":1770323455198,"stop":1770323455198,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S]  Verify Url","time":{"start":1770323455198,"stop":1770323455198,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S]  Session Faker","time":{"start":1770323455198,"stop":1770323455199,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Delete Output Dir","time":{"start":1770323455198,"stop":1770323455198,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Envs","time":{"start":1770323455199,"stop":1770323455201,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Auth Client","time":{"start":1770323455201,"stop":1770323455201,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"[S] Create Test User","time":{"start":1770323455201,"stop":1770323455341,"duration":140},"status":"broken","statusMessage":"sqlalchemy.exc.NoResultFound: No row was found when one was required\n","statusTrace":"  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/_pytest/setuponly.py\", line 36, in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    return result.get_result()\n           ~~~~~~~~~~~~~~~~~^^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/pluggy/_result.py\", line 103, in get_result\n    raise exc.with_traceback(tb)\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/_pytest/fixtures.py\", line 1202, in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/_pytest/fixtures.py\", line 915, in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/conftest.py\", line 72, in create_test_user\n    existing_user = UserdataDb(envs).get_user(username=envs.test_username)\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/databases/userdata_db.py\", line 34, in get_user\n    return session.exec(statement).one()\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py\", line 1815, in one\n    return self._only_one_row(\n           ~~~~~~~~~~~~~~~~~~^\n        raise_for_second_row=True, raise_for_none=True, scalar=False\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/home/runner/work/niffler-py-st3/niffler-py-st3/niffler-e-2-e-tests-python/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py\", line 760, in _only_one_row\n    raise exc.NoResultFound(\n        \"No row was found when one was required\"\n    )\n","steps":[{"name":"DB: attach sql","time":{"start":1770323455332,"stop":1770323455332,"duration":0},"status":"passed","steps":[],"attachments":[{"uid":"da509471fdfdba37","name":"select niffler-userdata","source":"da509471fdfdba37.txt","type":"text/plain","size":27}],"parameters":[{"name":"cursor","value":"<cursor object at 0x7f2ac1850040; closed: 0>"},{"name":"statement","value":"'select pg_catalog.version()'"},{"name":"parameters","value":"immutabledict({})"},{"name":"context","value":"<sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x7f2ac18a1160>"}],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"DB: attach sql","time":{"start":1770323455333,"stop":1770323455334,"duration":1},"status":"passed","steps":[],"attachments":[{"uid":"c841cf4135e282db","name":"select niffler-userdata","source":"c841cf4135e282db.txt","type":"text/plain","size":23}],"parameters":[{"name":"cursor","value":"<cursor object at 0x7f2ac1850040; closed: 0>"},{"name":"statement","value":"'select current_schema()'"},{"name":"parameters","value":"immutabledict({})"},{"name":"context","value":"<sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x7f2ac189d590>"}],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"DB: attach sql","time":{"start":1770323455334,"stop":1770323455334,"duration":0},"status":"passed","steps":[],"attachments":[{"uid":"c342de0bbbf17e28","name":"show niffler-userdata","source":"c342de0bbbf17e28.txt","type":"text/plain","size":32}],"parameters":[{"name":"cursor","value":"<cursor object at 0x7f2ac1850040; closed: 0>"},{"name":"statement","value":"'show standard_conforming_strings'"},{"name":"parameters","value":"immutabledict({})"},{"name":"context","value":"<sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x7f2ac189d590>"}],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"DB: attach sql","time":{"start":1770323455340,"stop":1770323455340,"duration":0},"status":"passed","steps":[],"attachments":[{"uid":"1d0eb478638d463b","name":"SELECT niffler-userdata","source":"1d0eb478638d463b.txt","type":"text/plain","size":186}],"parameters":[{"name":"cursor","value":"<cursor object at 0x7f2ac1852f20; closed: 0>"},{"name":"statement","value":"'SELECT \"user\".id, \"user\".username, \"user\".currency, \"user\".firstname, \"user\".surname, \"user\".photo, \"user\".photo_small, \"user\".full_name \nFROM \"user\" \nWHERE \"user\".username = %(username_1)s'"},{"name":"parameters","value":"{'username_1': 'niffler_st3'}"},{"name":"context","value":"<sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x7f2ac1978fc0>"}],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":4,"shouldDisplayMessage":true,"attachmentsCount":4,"hasContent":true,"attachmentStep":false}],"afterStages":[],"labels":[{"name":"feature","value":"Spends"},{"name":"epic","value":"Niffler app"},{"name":"tag","value":"ACTIONS_UI"},{"name":"story","value":"Spend"},{"name":"parentSuite","value":"tests.ui"},{"name":"suite","value":"test_spending"},{"name":"subSuite","value":"TestSpendPage"},{"name":"host","value":"runnervmkj6or"},{"name":"thread","value":"9909-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.ui.test_spending"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"browser_name","value":"'chromium'"},{"name":"category","value":"'city'"},{"name":"spends","value":"SpendAdd(amount=49, description='West Melanieview', category=CategoryAdd(name='city', username=None, archived=None), spendDate='2025-11-27T09:50:52.837Z', currency='RUB')"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":["ACTIONS_UI"]},"source":"49df991fbfb11553.json","parameterValues":["'chromium'","'city'","SpendAdd(amount=49, description='West Melanieview', category=CategoryAdd(name='city', username=None, archived=None), spendDate='2025-11-27T09:50:52.837Z', currency='RUB')"]}